
# Automatic Font Parameter Optimisation

> Awfully messy code relating to my Master’s Thesis at Aalto University.

## Thesis

Link TBA

## ⚠️ Caveat

This code is horribly messy and may be hard to get to run correctly. It's mainly ment as a documentation of the experiments. Please, ask [me](mailto:kalle@kaljarv.com) if there's something that you would like clarified.

## Abstract

Designing a new typeface is a burdensome task with the number of glyphs needed ranging from ca. 240 for Western European scripts to more than 20,000 for Chinese. To automate it fully or partially, numerous approaches have been tried ever since the advent of digital typography in the 1960s. These have often dealt with parameterisation of font properties, such as letter height, midline position and types of serifs. More recently, various machine learning (ML) methods have been used to build font models directly from data. Despite superficial success, their results have been lacking especially in the level of details to the extent of not being usable.

This thesis combines elements of both these traditions by introducing an explicitly parameterized font model, which is automatically optimised using a perceptual ML model approximating legibility under impaired viewing conditions. The process, furthermore, allows the use of any differentiable function as the optimisation target, and a simple font matching task is also undertaken.

Crucially, the model is vector-based and thus more suited for font gener- ation than raster methods more common in the field of ML. On the other hand, the manual construction of the parameterized font model allows for the explicit enforcement of typographic conventions, whose learning from data alone has thus far proved unsuccessful. Finally, the parameter values can be adjusted by the user after optimization, which is more feasible with semantically simple, orthogonal parameters.

## Structure 

See the experiment notebooks for details on how the experiments were run and outputs:

* `01_experiment_1_match_font.ipynb`
* `02_experiment_2_ocr_models.ipynb`
* `03_experiment_3_optimise_with_ocr.ipynb`
* `04_font_statistics.ipynb` (auxiliary statistics)

Common classes and functions are contained in the `aifont` lib notebooks, which are converted to Python packages in the `aifont` folder by `nbdev`.

* `aifont_core.ipynb`
* `aifont_fontlearner.ipynb`
* `aifont_fontsampler.ipynb`
* `aifont_ocrlearner.ipynb`

## Installation

Main dependencies:
* Jupyter
* [nbdev@1.1.23](https://nbdev.fast.ai/) 
  * conda install -c fastai nbdev@1.1.23
* [fastai@2.5.3](https://docs.fast.ai/#Installing) 
  * conda install -c fastai fastai@2.5.3
* [diffvg@0.0.1](https://github.com/BachiLi/diffvg)
  * -c pytorch pytorch torchvision 
  * numpy
  * scikit-image
  * -c anaconda cmake
  * -c conda-forge ffmpeg
* [CORnet@0.1.0](https://github.com/dicarlolab/CORnet)
  * pip install git+https://github.com/dicarlolab/CORnet

Datasets needed for Experiment 2:
* See §Data Sources in `aifont_ocrlearner.ipynb` for details
  * [A–Z Handwritten Fonts](https://www.kaggle.com/datasets/sachinpatel21/az-handwritten-alphabets-in-csv-format)
  * [TMNIST](https://www.kaggle.com/datasets/nikbearbrown/tmnist-alphabet-94-characters)
  * [Google Fonts](https://github.com/google/fonts)

Also, add the repo directory to `PATH` to allow python to load the `aifont` lib generated by `nbdev`.

## Author

Kalle Järvenpää<br>
[kalle@kaljarv.com](mailto:kalle@kaljarv.com)<br>
[kaljarv.com](https://kaljarv.com/)