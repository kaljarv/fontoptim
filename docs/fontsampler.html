---

title: aifont.fontsampler


keywords: fastai
sidebar: home_sidebar

summary: "Utilities to create images from Google Fonts. Code mostly by https://erraticgenerator.com/blog/use-google-fonts-for-machine-learning-part1/"
description: "Utilities to create images from Google Fonts. Code mostly by https://erraticgenerator.com/blog/use-google-fonts-for-machine-learning-part1/"
nb_path: "01_fontsampler.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_fontsampler.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<<<<<<< HEAD
<h2 id="Rendering-Font-Images">Rendering Font Images<a class="anchor-link" href="#Rendering-Font-Images"> </a></h2><blockquote><p>Selecting Google Fonts and rendering font images.</p>
=======
<h2 id="Getting-Font-Metadata">Getting Font Metadata<a class="anchor-link" href="#Getting-Font-Metadata"> </a></h2><blockquote><p>Get font metadata from the Google Fonts API. Needed only once. You need an API key for this.</p>
>>>>>>> 65b295bccddce1c873d023dc0a9c0fb31c2f440d
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<<<<<<< HEAD
</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">FontSampler</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Sample Google Fonts and render as images. `df` or `df_path` should point to font annotations</span>
<span class="sd">       (see `create_font_annotations`), `font_path` to the root folder of the ofl fonts. Control</span>
<span class="sd">       font selection with `variants`, `subsets` and `category`, which can be either strings or </span>
<span class="sd">       regexs.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">df_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;data/google-fonts-annotation.csv&quot;</span><span class="p">,</span> 
        <span class="n">font_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;data/fonts&quot;</span><span class="p">,</span> <span class="n">variants</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">subsets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
        <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">image_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">256</span><span class="p">,</span> <span class="n">image_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">256</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">df_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_path</span> <span class="o">=</span> <span class="n">font_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variants</span> <span class="o">=</span> <span class="n">variants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsets</span> <span class="o">=</span> <span class="n">subsets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">category</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_width</span> <span class="o">=</span> <span class="n">image_width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_height</span> <span class="o">=</span> <span class="n">image_height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_fonts_get_paths</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_fonts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paths</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter_fonts_get_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variants</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">subsets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
        <span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter the fonts list by the criteria and return a list of file paths.&quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
        <span class="n">font_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_path</span>
        <span class="k">if</span> <span class="n">variants</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">variants</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variants</span>
        <span class="k">if</span> <span class="n">subsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsets</span>
        <span class="k">if</span> <span class="n">category</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">category</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span>

        <span class="c1"># exceptions</span>
        <span class="k">if</span> <span class="n">variants</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">variants</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">variants</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> 
            <span class="n">variants</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">subsets</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">subsets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">subsets</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> 
            <span class="n">subsets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">category</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># apply filters</span>
        <span class="n">regex_filters</span> <span class="o">=</span> <span class="n">variants</span> <span class="o">+</span> <span class="n">subsets</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">category</span><span class="p">]</span>
        <span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">regex</span> <span class="ow">in</span> <span class="n">regex_filters</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">df_new</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">filtered_fontnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">family</span><span class="p">)</span>
        
        <span class="c1"># construct file paths</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">fontname</span> <span class="ow">in</span> <span class="n">filtered_fontnames</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">variants</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">]:</span> <span class="c1"># select all variants</span>
                <span class="n">sel</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">font_path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">fontname</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">/**/*.ttf&#39;</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">variant</span> <span class="ow">in</span> <span class="n">variants</span><span class="p">:</span>
                    <span class="n">sel</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">font_path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">fontname</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s1">/**/</span><span class="si">{</span><span class="n">fontname</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">variant</span><span class="si">}</span><span class="s1">.ttf&#39;</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
                    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
                        <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No matching fonts found!&quot;</span><span class="p">)</span>
        <span class="c1"># print(f&#39;Found {len(paths)} font files.&#39;)</span>

        <span class="c1"># Reset index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">paths</span>

    <span class="k">def</span> <span class="nf">render_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
        <span class="n">font_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">image_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">image_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
        <span class="n">as_normalised_array</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Render the given text as black on white and return either as a normalised </span>
<span class="sd">           numpy array of (alpha) values or a PIL Image. If called without font_index, </span>
<span class="sd">           will iterate over all paths and return None once the end is reached.&quot;&quot;&quot;</span>

        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paths</span>
        <span class="k">if</span> <span class="n">font_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">font_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">font_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">font_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_index</span>

        <span class="c1"># sample text and font</span>
        <span class="k">if</span> <span class="n">text_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text_size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_height</span> <span class="o">*</span> <span class="mf">.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">image_width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">image_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_width</span>
        <span class="k">if</span> <span class="n">image_height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">image_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_height</span>
        
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">image_width</span>  <span class="o">*</span> <span class="mf">.5</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Try to find a nice y location for the text keeping in mind that descenders</span>
            <span class="c1"># will reach below this point and might thus fall offcanvas</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">text_size</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">image_height</span> <span class="o">-</span> <span class="n">text_size</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">font_index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)],</span> <span class="n">text_size</span><span class="p">)</span>

        <span class="c1"># get text info (not being used but may be useful)</span>
        <span class="c1"># text_width, text_height = font.getsize(text)</span>
        <span class="c1"># left, top, right, bottom = font.getbbox(text)</span>
        <span class="c1"># print(left, top, right, bottom)</span>

        <span class="c1"># create a blank canvas</span>
        <span class="n">canvas</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span><span class="p">),</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>

        <span class="c1"># draw the text onto the text canvas</span>
        <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">canvas</span><span class="p">)</span>
        <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">text</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>

        <span class="c1"># Convert to normalised list if needed</span>
        <span class="k">if</span> <span class="n">as_normalised_array</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">([(</span><span class="mi">255</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">canvas</span><span class="o">.</span><span class="n">getdata</span><span class="p">())],</span>
                              <span class="p">(</span><span class="n">image_height</span><span class="p">,</span> <span class="n">image_width</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">canvas</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Render a letter as a grayscale image.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">FontSampler</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="s2">&quot;sans-serif&quot;</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">render_text</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">);</span> <span class="n">img</span>
</pre></div>

    </div>
</div>
</div>

=======
>>>>>>> 65b295bccddce1c873d023dc0a9c0fb31c2f440d
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<<<<<<< HEAD

<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,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"
>
=======
<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_google_font_metadata" class="doc_header"><code>create_google_font_metadata</code><a href="https://github.com/kaljarv/aifont/tree/master/aifont/core.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_google_font_metadata</code>(<strong><code>data_path</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>api_key</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>save_path</code></strong>=<em><code>'google-fonts-annotation.csv'</code></em>)</p>
</blockquote>
<p>Get Google Fonts metadata either from the API using <code>api_key</code> or from
a local file at <code>data_path</code> and save the data as csv in <code>save_path</code>.
Also returns the data frame.</p>

>>>>>>> 65b295bccddce1c873d023dc0a9c0fb31c2f440d
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<<<<<<< HEAD
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or as a numpy matrix.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np_img</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">render_text</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">as_normalised_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">font_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape: </span><span class="si">{</span><span class="n">np_img</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np_img</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Shape: (256, 256)
[[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
</pre>
</div>
</div>

</div>
</div>
=======
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
>>>>>>> 65b295bccddce1c873d023dc0a9c0fb31c2f440d

</div>
    {% endraw %}

<<<<<<< HEAD
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To use it with <code>diffvg</code>, use the values as the A-band of the RGBA tensors.</p>

</div>
</div>
</div>
=======
>>>>>>> 65b295bccddce1c873d023dc0a9c0fb31c2f440d
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<<<<<<< HEAD
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">wd_ht</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">np_img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">wd_ht_a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">wd_ht</span><span class="p">,</span> <span class="n">wd_ht</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">wd_ht_rgba</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">wd_ht_a</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">wd_ht</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">wd_ht_a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">wd_ht_rgba</span><span class="o">.</span><span class="n">shape</span>
=======
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
>>>>>>> 65b295bccddce1c873d023dc0a9c0fb31c2f440d
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<<<<<<< HEAD


<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([256, 256]), torch.Size([256, 256, 1]), torch.Size([256, 256, 4]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-Font-Metadata">Getting Font Metadata<a class="anchor-link" href="#Getting-Font-Metadata"> </a></h2><blockquote><p>Get font metadata from the Google Fonts API. Needed only once. You need an API key for this.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_font_annotations" class="doc_header"><code>create_font_annotations</code><a href="https://github.com/kaljarv/aifont/tree/master/aifont/fontsampler.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_font_annotations</code>(<strong><code>data_path</code></strong>:<code>str</code>=<em><code>'data/webfonts.json'</code></em>, <strong><code>api_key</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>save_path</code></strong>=<em><code>'data/google-fonts-annotation.csv'</code></em>)</p>
</blockquote>
<p>Get Google Fonts metadata either from the API using <code>api_key</code> or from
a local file at <code>data_path</code> and save the data as csv in <code>save_path</code>.
Also returns the data frame.</p>

</div>

=======
<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_core.ipynb.
Converted 01_fontsampler.ipynb.
Converted index.ipynb.
</pre>
</div>
>>>>>>> 65b295bccddce1c873d023dc0a9c0fb31c2f440d
</div>

</div>
</div>

</div>
    {% endraw %}

<<<<<<< HEAD
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

=======
>>>>>>> 65b295bccddce1c873d023dc0a9c0fb31c2f440d
</div>
 

